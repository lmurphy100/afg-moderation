Ran model
c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py:2479: UserWarning: You are calling .generate() with the `input_ids` being on a device type different than your model's device. `input_ids` is on cuda, whereas the model is on cpu. You may experience unexpected behaviors or slower generation. Please make sure that you have put `input_ids` to the correct device by calling for example input_ids = input_ids.to('cpu') before running `.generate()`.
  warnings.warn(
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
[36m[1mweave[0m: Evaluated 1 of 108 examples
[36m[1mweave[0m: Evaluated 2 of 108 examples
[36m[1mweave[0m: Evaluated 3 of 108 examples
[36m[1mweave[0m: Evaluated 4 of 108 examples
[36m[1mweave[0m: Evaluated 5 of 108 examples
[36m[1mweave[0m: Evaluated 6 of 108 examples
[36m[1mweave[0m: Evaluated 7 of 108 examples
[36m[1mweave[0m: Evaluated 8 of 108 examples
[36m[1mweave[0m: Evaluated 9 of 108 examples
[36m[1mweave[0m: Evaluated 10 of 108 examples
[36m[1mweave[0m: Evaluated 11 of 108 examples
[36m[1mweave[0m: Evaluated 12 of 108 examples
[36m[1mweave[0m: Evaluated 13 of 108 examples
[36m[1mweave[0m: Evaluated 14 of 108 examples
[36m[1mweave[0m: Evaluated 15 of 108 examples
[36m[1mweave[0m: Evaluated 16 of 108 examples
[36m[1mweave[0m: Evaluated 17 of 108 examples
[36m[1mweave[0m: Evaluated 18 of 108 examples
[36m[1mweave[0m: Evaluated 19 of 108 examples
[36m[1mweave[0m: Evaluated 20 of 108 examples
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
[36m[1mweave[0m: Evaluated 21 of 108 examples
[36m[1mweave[0m: Evaluated 22 of 108 examples
[36m[1mweave[0m: Evaluated 23 of 108 examples
[36m[1mweave[0m: Evaluated 24 of 108 examples
[36m[1mweave[0m: Evaluated 25 of 108 examples
[36m[1mweave[0m: Evaluated 26 of 108 examples
[36m[1mweave[0m: Evaluated 27 of 108 examples
[36m[1mweave[0m: Evaluated 28 of 108 examples
[36m[1mweave[0m: Evaluated 29 of 108 examples
[36m[1mweave[0m: Evaluated 30 of 108 examples
[36m[1mweave[0m: Evaluated 31 of 108 examples
[36m[1mweave[0m: Evaluated 32 of 108 examples
[36m[1mweave[0m: Evaluated 33 of 108 examples
[36m[1mweave[0m: Evaluated 34 of 108 examples
[36m[1mweave[0m: Evaluated 35 of 108 examples
[36m[1mweave[0m: Evaluated 36 of 108 examples
[36m[1mweave[0m: Evaluated 37 of 108 examples
[36m[1mweave[0m: Evaluated 38 of 108 examples
[36m[1mweave[0m: Evaluated 39 of 108 examples
[36m[1mweave[0m: Evaluated 40 of 108 examples
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: 🍩 https://weave.assessmentforgood.cloud/liammurphy7657/dataset-severitylevels-104/r/call/0197a303-f9ff-76c2-8f0e-1220eddb9714
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
[36m[1mweave[0m: Evaluated 41 of 108 examples
[36m[1mweave[0m: Evaluated 42 of 108 examples
[36m[1mweave[0m: Evaluated 43 of 108 examples
[36m[1mweave[0m: Evaluated 44 of 108 examples
[36m[1mweave[0m: Evaluated 45 of 108 examples
[36m[1mweave[0m: Evaluated 46 of 108 examples
[36m[1mweave[0m: Evaluated 47 of 108 examples
[36m[1mweave[0m: Evaluated 48 of 108 examples
[36m[1mweave[0m: Evaluated 49 of 108 examples
[36m[1mweave[0m: Evaluated 50 of 108 examples
[36m[1mweave[0m: Evaluated 51 of 108 examples
[36m[1mweave[0m: Evaluated 52 of 108 examples
[36m[1mweave[0m: Evaluated 53 of 108 examples
[36m[1mweave[0m: Evaluated 54 of 108 examples
[36m[1mweave[0m: Evaluated 55 of 108 examples
[36m[1mweave[0m: Evaluated 56 of 108 examples
[36m[1mweave[0m: Evaluated 57 of 108 examples
[36m[1mweave[0m: Evaluated 58 of 108 examples
[36m[1mweave[0m: Evaluated 59 of 108 examples
[36m[1mweave[0m: Evaluated 60 of 108 examples
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
[36m[1mweave[0m: Evaluated 61 of 108 examples
[36m[1mweave[0m: Evaluated 62 of 108 examples
[36m[1mweave[0m: Evaluated 63 of 108 examples
[36m[1mweave[0m: Evaluated 64 of 108 examples
[36m[1mweave[0m: Evaluated 65 of 108 examples
[36m[1mweave[0m: Evaluated 66 of 108 examples
[36m[1mweave[0m: Evaluated 67 of 108 examples
[36m[1mweave[0m: Evaluated 68 of 108 examples
[36m[1mweave[0m: Evaluated 69 of 108 examples
[36m[1mweave[0m: Evaluated 70 of 108 examples
[36m[1mweave[0m: Evaluated 71 of 108 examples
[36m[1mweave[0m: Evaluated 72 of 108 examples
[36m[1mweave[0m: Evaluated 73 of 108 examples
[36m[1mweave[0m: Evaluated 74 of 108 examples
[36m[1mweave[0m: Evaluated 75 of 108 examples
[36m[1mweave[0m: Evaluated 76 of 108 examples
[36m[1mweave[0m: Evaluated 77 of 108 examples
[36m[1mweave[0m: Evaluated 78 of 108 examples
[36m[1mweave[0m: Evaluated 79 of 108 examples
[36m[1mweave[0m: Evaluated 80 of 108 examples
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
[36m[1mweave[0m: Evaluated 81 of 108 examples
[36m[1mweave[0m: Evaluated 82 of 108 examples
[36m[1mweave[0m: Evaluated 83 of 108 examples
[36m[1mweave[0m: Evaluated 84 of 108 examples
[36m[1mweave[0m: Evaluated 85 of 108 examples
[36m[1mweave[0m: Evaluated 86 of 108 examples
[36m[1mweave[0m: Evaluated 87 of 108 examples
[36m[1mweave[0m: Evaluated 88 of 108 examples
[36m[1mweave[0m: Evaluated 89 of 108 examples
[36m[1mweave[0m: Evaluated 90 of 108 examples
[36m[1mweave[0m: Evaluated 91 of 108 examples
[36m[1mweave[0m: Evaluated 92 of 108 examples
[36m[1mweave[0m: Evaluated 93 of 108 examples
[36m[1mweave[0m: Evaluated 94 of 108 examples
[36m[1mweave[0m: Evaluated 95 of 108 examples
[36m[1mweave[0m: Evaluated 96 of 108 examples
[36m[1mweave[0m: Evaluated 97 of 108 examples
[36m[1mweave[0m: Evaluated 98 of 108 examples
[36m[1mweave[0m: Evaluated 99 of 108 examples
[36m[1mweave[0m: Evaluated 100 of 108 examples
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
Ran model
[36m[1mweave[0m: model_output failed
[36m[1mweave[0m: Traceback (most recent call last):
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\flow\model.py", line 143, in apply_model_async
[36m[1mweave[0m:     model_output, model_call = await async_call_op(
[36m[1mweave[0m:                                ^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\weave\trace\op.py", line 636, in _call_async_func
[36m[1mweave[0m:     res = await func(*args, **kwargs)
[36m[1mweave[0m:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 46, in predict
[36m[1mweave[0m:     output = hf_model.generate(
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
[36m[1mweave[0m:     return func(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 2597, in generate
[36m[1mweave[0m:     result = self._sample(
[36m[1mweave[0m:              ^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\generation\utils.py", line 3557, in _sample
[36m[1mweave[0m:     outputs = self(**model_inputs, return_dict=True)
[36m[1mweave[0m:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 688, in forward
[36m[1mweave[0m:     outputs: BaseModelOutputWithPast = self.model(
[36m[1mweave[0m:                                        ^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\utils\generic.py", line 969, in wrapper
[36m[1mweave[0m:     output = func(self, *args, **kwargs)
[36m[1mweave[0m:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 422, in forward
[36m[1mweave[0m:     inputs_embeds = self.embed_tokens(input_ids)
[36m[1mweave[0m:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1740, in _wrapped_call_impl
[36m[1mweave[0m:     return self._call_impl(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\module.py", line 1751, in _call_impl
[36m[1mweave[0m:     return forward_call(*args, **kwargs)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\modules\sparse.py", line 190, in forward
[36m[1mweave[0m:     return F.embedding(
[36m[1mweave[0m:            ^^^^^^^^^^^^
[36m[1mweave[0m:   File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\torch\nn\functional.py", line 2551, in embedding
[36m[1mweave[0m:     return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
[36m[1mweave[0m:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[36m[1mweave[0m: RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cpu and cuda:0! (when checking argument for argument index in method wrapper_CUDA__index_select)
[36m[1mweave[0m:
[36m[1mweave[0m: Evaluated 101 of 108 examples
[36m[1mweave[0m: Evaluated 102 of 108 examples
[36m[1mweave[0m: Evaluated 103 of 108 examples
[36m[1mweave[0m: Evaluated 104 of 108 examples
[36m[1mweave[0m: Evaluated 105 of 108 examples
[36m[1mweave[0m: Evaluated 106 of 108 examples
[36m[1mweave[0m: Evaluated 107 of 108 examples
[36m[1mweave[0m: Evaluated 108 of 108 examples
[36m[1mweave[0m: Evaluation summary {
[36m[1mweave[0m:   "LGCategoryScorer": null,
[36m[1mweave[0m:   "LGBinaryScorer": null,
[36m[1mweave[0m:   "model_latency": {
[36m[1mweave[0m:     "mean": 0.02346796680379797
[36m[1mweave[0m:   }
[36m[1mweave[0m: }
Pred encoded: []
True encoded: []
Traceback (most recent call last):
  File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\llamaguard8b_weave.py", line 43, in <module>
    model.make_confusion_matrix()
  File "c:\Users\LiamMurphy(DMC)\Documents\Weave\eval\weave_llamaguard\LLamaGuardClasses.py", line 77, in make_confusion_matrix
    report_dict = classification_report(
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\sklearn\utils\_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LiamMurphy(DMC)\Documents\Weave\venv\Lib\site-packages\sklearn\metrics\_classification.py", line 2693, in classification_report
    raise ValueError(
ValueError: Number of classes, 0, does not match size of target_names, 7. Try specifying the labels parameter
